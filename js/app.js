"use strict";var t=document.querySelector(".burger"),e=document.querySelector(".header__nav"),n=e.querySelectorAll(".nav__list-link");t.addEventListener("click",(function(){t.classList.toggle("burger--active"),e.classList.toggle("nav--active")})),n.forEach((function(n){n.addEventListener("click",(function(){t.classList.toggle("burger--active"),e.classList.toggle("nav--active")}))}));var r=document.querySelector(".cart__btn"),a=document.querySelector(".mini-cart");function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}r.addEventListener("click",(function(){a.classList.toggle("mini-cart--visible")})),document.addEventListener("click",(function(t){t.target.classList.contains("mini-cart")||t.target.closest(".mini-cart")||t.target.classList.contains("cart__btn")||a.classList.remove("mini-cart--visible")})),document.querySelector(".cart-modal .modal__close").addEventListener("click",(function(){y.close()})),document.querySelectorAll(".faq-accordion").forEach((function(t){t.addEventListener("click",(function(t){var e=t.currentTarget,n=e.querySelector(".faq-accordion__control"),r=e.querySelector(".faq-accordion__content");e.classList.toggle("open"),e.classList.contains("open")?(n.setAttribute("aria-expanded",!0),r.setAttribute("aria-hidden",!1),r.style.maxHeight=r.scrollHeight+"px"):(n.setAttribute("aria-expanded",!1),r.setAttribute("aria-hidden",!0),r.style.maxHeight=null)}))})),ymaps.ready((function(){new ymaps.Map("map",{center:[55.76,37.64],zoom:14,controls:[]})}));var s=document.querySelector(".catalog-list"),l=document.querySelector(".catalog__more"),u=document.querySelector('[data-graph-target="prod-modal"] .modal-content'),d=u.querySelector(".modal-slider .swiper-wrapper"),m=u.querySelector(".modal-slider .modal-preview"),_=u.querySelector(".modal-info__wrapper"),p=u.querySelector(".modal-prod-descr"),v=u.querySelector(".prod-chars"),f=u.querySelector(".prod-modal__video"),y=null,h=9,b=null,g=function(t){return String(t).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")},q=new Swiper(".modal-slider__container",{autoplay:{delay:3e3},slidesPerView:1,spaceBetween:20});if(s){var S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;fetch("./resources/data/data.json").then((function(t){return t.json()})).then((function(e){b=e.length,s.innerHTML="";for(var n=0;n<b;n++)if(n<t){var r=e[n];s.innerHTML+='\n              <li class="catalog-list__item">\n                <article class="product">\n                  <div class="product__image">\n                    <img src="'.concat(r.mainImage,'" alt="').concat(r.title,'">\n                    <div class="product__btns">\n                      <button class="btn-reset product__btn" data-graph-path="prod-modal" data-id="').concat(r.id,'" aria-label="Показать информацию о товаре">\n                        <svg>\n                          <use xlink:href="img/sprite.svg#eye"></use>\n                        </svg>\n                      </button>\n                      <button class="btn-reset product__btn add-to-cart-btn" data-id="').concat(r.id,'" aria-label="Добавить товар в корзину">\n                        <svg>\n                          <use xlink:href="img/sprite.svg#cart"></use>\n                        </svg>\n                      </button>\n                    </div>\n                  </div>\n                  <h3 class="product__title">').concat(r.title,'</h3>\n                  <span class="product__price">').concat(g(r.price)," р</span>\n                </article>\n              </li>\n            ")}})).then((function(){document.querySelectorAll(".product__title").forEach((function(t){$clamp(t,{clamp:"22px"})})),document.querySelectorAll(".product__btn").forEach((function(t){t.addEventListener("focus",(function(t){t.currentTarget.closest(".product__btns").classList.add("product__btns--active")}),!0),t.addEventListener("blur",(function(t){t.currentTarget.closest(".product__btns").classList.remove("product__btns--active")}),!0)})),H(),y=new GraphModal({isOpen:function(t){if(t.modalContainer.classList.contains("prod-modal")){var e=t.previousActiveElement.dataset.id;w(e),q.update()}}})}))};S(h);var w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;fetch("./resources/data/data.json").then((function(t){return t.json()})).then((function(e){d.innerHTML="",m.innerHTML="",_.innerHTML="",p.textContent="",v.innerHTML="",f.innerHTML="";var n,r=i(e);try{var a=function(){var e=n.value;if(e.id==t){var r=e.gallery.map((function(t,e){return'\n                <div class="swiper-slide" data-index="'.concat(e,'">\n                  <img src="').concat(t,'" alt="">\n                </div>\n              ')})),a=e.gallery.map((function(t,e){return'\n                <div class="modal-preview__item '.concat(0===e?"modal-preview__item--active":"",'" tabindex="0" data-index="').concat(e,'">\n                  <img src="').concat(t,'" alt="">\n                </div>\n              ')})),i=e.sizes.map((function(t,e){return'\n                <li class="modal-sizes__item">\n                  <button class="btn-reset modal-sizes__btn">'.concat(t,"</button>\n                </li>\n              ")}));d.innerHTML=r.join(""),m.innerHTML=a.join(""),_.innerHTML='\n              <div class="modal-info__top">\n                <span class="modal-info__vendor">Артикул: '.concat(e.vendor,'</span>\n                <span class="modal-info__quantity">В наличии: <span>').concat(e.quantity,'</span></span>\n              </div>\n              <h3 class="modal-info__title">').concat(e.title,'</h3>\n              <div class="modal-info__rate">\n                <img src="img/star.svg" alt="Рейтинг 5 из 5">\n                <img src="img/star.svg" alt="">\n                <img src="img/star.svg" alt="">\n                <img src="img/star.svg" alt="">\n                <img src="img/star.svg" alt="">\n              </div>\n              <div class="modal-info__sizes">\n                <span class="modal-info__subtitle">Выберите размер</span>\n                <ul class="list-reset modal-info__sizes-list modal-sizes">\n                  ').concat(i.join(""),'\n                </ul>\n              </div>\n              <div class="modal-info__price">\n                <span class="modal-info__current-price">').concat(g(e.price),' р</span>\n                <span class="modal-info__old-price">').concat(g(e.oldPrice)?g(e.oldPrice)+" р":"","</span>\n              </div>\n            "),p.textContent=e.description;var c="";Object.keys(e.chars).forEach((function(t){c+='<p class="prod-bottom__descr prod-chars__item">'.concat(t,": ").concat(e.chars[t],"</p>")})),v.innerHTML=c,e.video?(f.style.display="block",f.innerHTML='\n                <iframe src="'.concat(e.video,'"\n                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\n                allowfullscreen></iframe>\n              ')):f.style.display="none"}};for(r.s();!(n=r.n()).done;)a()}catch(t){r.e(t)}finally{r.f()}})).then((function(){q.update(),q.on("slideChangeTransitionEnd",(function(){var t=document.querySelector(".swiper-slide-active").dataset.index;document.querySelectorAll(".modal-preview__item").forEach((function(t){t.classList.remove("modal-preview__item--active")})),document.querySelector('.modal-preview__item[data-index="'.concat(t,'"]')).classList.add("modal-preview__item--active")})),document.querySelectorAll(".modal-preview__item").forEach((function(t){t.addEventListener("click",(function(t){var e=parseInt(t.currentTarget.dataset.index);document.querySelectorAll(".modal-preview__item").forEach((function(t){t.classList.remove("modal-preview__item--active")})),t.currentTarget.classList.add("modal-preview__item--active"),q.slideTo(e)}))}))}))};l.addEventListener("click",(function(t){S(h+=3),l.style.display=h>=b?"none":"block"}))}var L=0,x=document.querySelector(".mini-cart__list"),k=document.querySelector(".mini-cart__summ"),E=document.querySelector(".cart__count"),T=function(t){return t.replace(/\s/g,"")},A=function(t){return L-=t},z=function(){k.textContent="".concat(g(L)," р")},M=function(t){E.textContent=t},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;fetch("./resources/data/data.json").then((function(t){return t.json()})).then((function(e){var n,r=i(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.id==t)return x.insertAdjacentHTML("afterbegin",'\n          <li class="mini-cart__item" data-id="'.concat(a.id,'">\n          <article class="mini-cart__product mini-product">\n            <div class="mini-product__image">\n              <img src="').concat(a.mainImage,'" alt="').concat(a.title,'">\n            </div>\n            <div class="mini-product__content">\n              <div class="mini-product__text">\n                <h3 class="mini-product__title">').concat(a.title,'</h3>\n                <span class="mini-product__price">').concat(g(a.price),'</span>\n              </div>\n              <button class="btn-reset mini-product__delete" aria-label="Удалить товар">\n              Удалить\n                <svg>\n                  <use xlink:href="img/sprite.svg#trash"></use>\n                </svg>\n              </button>\n            </div>\n          </article>\n        </li>\n          ')),a}}catch(t){r.e(t)}finally{r.f()}})).then((function(t){var e;e=t.price,L+=e,z();var n=document.querySelectorAll(".mini-cart__list .mini-cart__item").length;n>0&&E.classList.add("cart__count--visible"),M(n)}))},H=function(){document.querySelectorAll(".add-to-cart-btn").forEach((function(t){t.addEventListener("click",(function(t){var e=t.currentTarget.dataset.id;C(e),document.querySelector(".cart__btn").classList.remove("cart__btn--inactive"),t.currentTarget.classList.add("product__btn--disabled")}))})),x.addEventListener("click",(function(t){if(t.target.classList.contains("mini-product__delete")){var e=t.target.closest(".mini-cart__item"),n=parseInt(T(e.querySelector(".mini-product__price").textContent)),r=e.dataset.id;document.querySelector('.add-to-cart-btn[data-id="'.concat(r,'"]')).classList.remove("product__btn--disabled"),e.remove(),A(n),z();var i=document.querySelectorAll(".mini-cart__list .mini-cart__item").length;0==i&&(E.classList.remove("cart__count--visible"),a.classList.remove("mini-cart--visible"),document.querySelector(".cart__btn").classList.add("cart__btn--inactive")),M(i)}}))},I=document.querySelector(".mini-cart__btn"),$=document.querySelector(".cart-modal-order__list"),O=document.querySelector(".cart-modal-order__quantity span"),P=document.querySelector(".cart-modal-order__summ span"),U=document.querySelector(".cart-modal-order__show");function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function c(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(a=r.key,i=void 0,i=function(t,e){if("object"!==B(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(a,"string"),"symbol"===B(i)?i:String(i)),r)}var a,i}I.addEventListener("click",(function(){var t=document.querySelector(".mini-cart__list").innerHTML;$.innerHTML=t,O.textContent="".concat(document.querySelectorAll(".mini-cart__list .mini-cart__item").length," шт"),P.textContent="".concat(k.textContent)})),U.addEventListener("click",(function(){U.classList.toggle("cart-modal-order__show--active"),$.classList.toggle("cart-modal-order__list--visible")})),$.addEventListener("click",(function(t){if(t.target.classList.contains("mini-product__delete")){var e=t.target.closest(".mini-cart__item"),n=parseInt(T(e.querySelector(".mini-product__price").textContent)),r=e.dataset.id;document.querySelector('.add-to-cart-btn[data-id="'.concat(r,'"]')).classList.remove("product__btn--disabled"),e.style.display="none",e.remove(),document.querySelector('.mini-cart__item[data-id="'.concat(r,'"]')).remove(),A(n),z(),setTimeout((function(){var t=document.querySelectorAll(".cart-modal-order__list .mini-cart__item").length;0==t&&(E.classList.remove("cart__count--visible"),a.classList.remove("mini-cart--visible"),document.querySelector(".cart__btn").classList.add("cart__btn--inactive"),y.close()),M(t)}),100)}O.textContent="".concat(document.querySelectorAll(".mini-cart__list .mini-cart__item").length," шт"),P.textContent="".concat(k.textContent)})),document.querySelector(".modal__close").addEventListener("click",(function(){y.close()}));var R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=t.number,a=t.title,i=n.nextBtnText,c=t.answers.map((function(e){return"checkbox"===e.type?'\n      <li class="quiz-question__item">\n        <img src="img/sneaker.jpg" alt="">\n        <label class="custom-checkbox quiz-question__label">\n          <input type="'.concat(e.type,'" class="custom-checkbox__field quiz-question__answer" data-valid="false" name="').concat(t.answer_alias,'" ').concat("text"==e.type?'placeholder="Введите ваш вариант"':"",' value="').concat("text"!==e.type?e.answer_title:"",'">\n          <span class="custom-checkbox__content">').concat(e.answer_title,"</span>\n        </label>\n      </li>\n      "):"textarea"===e.type?'\n      <label class="quiz-question__label">\n        <textarea class="quiz-question__message" placeholder="'.concat(e.answer_title,'"></textarea>\n      </label>\n      '):'\n        <label class="quiz-question__label">\n          <input type="'.concat(e.type,'" data-valid="false" class="quiz-question__answer" name="').concat(t.answer_alias,'" ').concat("text"==e.type?'placeholder="Введите ваш вариант"':"",' value="').concat("text"!==e.type?e.answer_title:"",'">\n          <span>').concat(e.answer_title,"</span>\n        </label>\n      ")}));return'\n\t\t\t<div class="quiz-question">\n\t\t\t\t<h3 class="quiz-question__title">'.concat(a,'</h3>\n\t\t\t\t<ul class="list-reset quiz-question__answers">\n\t\t\t\t\t').concat(c.join(""),'\n\t\t\t\t</ul>\n        <div class="quiz-bottom">\n          <div class="quiz-question__count">').concat(r," из ").concat(e,'</div>\n          <button type="button" class="btn btn-reset btn--thirdly quiz-question__btn" data-next-btn>').concat(i,"</button>\n        </div>\n\t\t\t</div>\n\t")},F=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$el=document.querySelector(e),this.options=r,this.data=n,this.counter=0,this.dataLength=this.data.length,this.resultArray=[],this.tmp={},this.init(),this.events()}var e,n,r;return e=t,(n=[{key:"init",value:function(){console.log("init!"),this.$el.innerHTML=R(this.data[this.counter],this.dataLength,this.options)}},{key:"nextQuestion",value:function(){console.log("next question!"),this.valid()?this.counter+1<this.dataLength?(this.counter++,this.$el.innerHTML=R(this.data[this.counter],this.dataLength,this.options),this.counter+1==this.dataLength&&(document.querySelector(".quiz-question__answers").style.display="block")):(console.log("А все! конец!"),document.querySelector(".quiz-questions").style.display="none",document.querySelector(".last-question").style.display="block",document.querySelector(".quiz__title").textContent="Ваша подборка готова!",document.querySelector(".quiz__descr").textContent="Оставьте свои контактные данные, чтобы бы мы могли отправить подготовленный для вас каталог"):console.log("Не валидно!")}},{key:"events",value:function(){var t=this;console.log("events!"),this.$el.addEventListener("click",(function(e){e.target==document.querySelector("[data-next-btn]")&&(t.addToSend(),t.nextQuestion()),e.target==document.querySelector("[data-send]")&&t.send()})),this.$el.addEventListener("change",(function(e){"INPUT"==e.target.tagName&&("checkbox"!==e.target.type&&"radio"!==e.target.type&&t.$el.querySelectorAll("input").forEach((function(t){t.checked=!1})),t.tmp=t.serialize(t.$el))}))}},{key:"valid",value:function(){var t=!1,e=this.$el.querySelector("textarea");return e&&e.value.length>0?t=!0:(this.$el.querySelectorAll("input").forEach((function(e){if("INPUT"===e.nodeName)switch(e.type){case"text":e.value?t=!0:e.classList.add("error");case"checkbox":e.checked?t=!0:e.classList.add("error");case"radio":e.checked?t=!0:e.classList.add("error")}})),t)}},{key:"addToSend",value:function(){this.resultArray.push(this.tmp)}},{key:"send",value:function(){if(this.valid()){var t,e=new FormData,n=i(this.resultArray);try{for(n.s();!(t=n.n()).done;){var r=t.value;for(var a in r)e.append(a,r[a].substring(0,r[a].length-1))}}catch(t){n.e(t)}finally{n.f()}fetch("mail.php",{method:"POST",body:e})}}},{key:"serialize",value:function(t){var e,n={},r="";if("object"==B(t)&&"FORM"==t.nodeName)for(var a=t.elements.length,i=0;i<a;i++)if((e=t.elements[i]).name&&!e.disabled&&"file"!=e.type&&"reset"!=e.type&&"submit"!=e.type&&"button"!=e.type)if("select-multiple"==e.type)for(j=t.elements[i].options.length-1;j>=0;j--)e.options[j].selected&&(n[n.length]=encodeURIComponent(e.name)+"="+encodeURIComponent(e.options[j].value));else("checkbox"!=e.type&&"radio"!=e.type&&e.value||e.checked)&&(r+=e.value+",",n[e.name]=r);return n}}])&&N(e.prototype,n),r&&N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();window.quiz=new F(".quiz-form .quiz-questions",[{number:1,title:"Какой тип кроссовок рассматриваете?",answer_alias:"type",answers:[{answer_title:"кеды",type:"checkbox"},{answer_title:"кеды",type:"checkbox"},{answer_title:"кеды",type:"checkbox"},{answer_title:"кеды",type:"checkbox"},{answer_title:"кеды",type:"checkbox"},{answer_title:"кеды",type:"checkbox"}]},{number:2,title:"Какой размер вам подойдет??",answer_alias:"size",answers:[{answer_title:"менее 36",type:"checkbox"},{answer_title:"36-38",type:"checkbox"},{answer_title:"39-41",type:"checkbox"},{answer_title:"42-44",type:"checkbox"},{answer_title:"45 и больше",type:"checkbox"}]},{number:3,title:"Уточните какие-либо моменты",answer_alias:"message",answers:[{answer_title:"Введите сообщение",type:"textarea"}]}],{nextBtnText:"Следующий шаг",sendBtnText:"Отправить"});var Q=document.getElementById("range-slider");if(Q){noUiSlider.create(Q,{start:[1e3,2e4],connect:!0,step:1,range:{min:[1e3],max:[2e4]}});var D=[document.getElementById("input-0"),document.getElementById("input-1")];Q.noUiSlider.on("update",(function(t,e){D[e].value=Math.round(t[e])}));D.forEach((function(t,e){t.addEventListener("change",(function(t){var n,r,a;n=e,r=t.currentTarget.value,(a=[null,null])[n]=r,Q.noUiSlider.set(a)}))}))}